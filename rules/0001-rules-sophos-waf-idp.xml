<!-- Basic: all WAF-Events -->
<group name="sophos_xgs_waf,">
  <rule id="100600" level="3">
    <field name="log_type">WAF</field>
    <description>Sophos WAF event</description>
    <group>sophos,sophos-xgs,waf</group>
  </rule>

<!-- all WAF-Anomaly -->
  <rule id="100601" level="10">
    <field name="log_type">WAF</field>
    <field name="reason">WAF Anomaly</field>
    <description>Sophos WAF anomaly</description>
    <group>sophos,sophos-xgs,waf,anomaly,sophos_xgs_critical</group>
  </rule>

<!-- Shows all 403 Blocks -->
  <rule id="100602" level="12">
    <if_sid>100601</if_sid>
    <field name="http_status">403</field>
    <description>Sophos WAF blocked 403</description>
    <group>sophos,sophos-xgs,waf,anomaly,blocked,sophos_xgs_critical</group>
  </rule>
</group>


  <!-- Basic: all IDP-Events -->
<group name="sophos_xgs_idp,">
  <rule id="101620" level="3">
    <match>log_type="IDP"</match>
    <description>Sophos XGS IDP event</description>
    <group>sophos,sophos-xgs,idp,sophos_xgs_critical</group>
  </rule>

  <!-- Drop (geblockt) -->
  <rule id="101621" level="7">
    <if_sid>101620</if_sid>
    <match>log_subtype="Drop"</match>
    <description>Sophos XGS IDP drop</description>
    <group>sophos,sophos-xgs,idp,drop,sophos_xgs_critical</group>
  </rule>

  <!-- Critical Severity -->
  <rule id="101622" level="15">
    <if_sid>101621</if_sid>
    <match>severity="Critical"</match>
    <description>Sophos XGS IDP drop critical</description>
    <group>sophos,sophos-xgs,idp,drop,critical,sophos_xgs_critical</group>
  </rule>

  <!-- Moderate Severity -->
  <rule id="101623" level="9">
    <if_sid>101621</if_sid>
    <match>severity="Moderate"</match>
    <description>Sophos XGS IDP drop warning</description>
    <group>sophos,sophos-xgs,idp,drop,warning,sophos_xgs_critical</group>
  </rule>
  
  <!-- Major Severity -->
  <rule id="101623" level="12">
    <if_sid>101621</if_sid>
    <match>severity="Moderate"</match>
    <description>Sophos XGS IDP drop warning</description>
    <group>sophos,sophos-xgs,idp,drop,warning,sophos_xgs_critical</group>
  </rule>

  <!-- Optional: show Detect/Allow -->
  <rule id="101624" level="5">
    <if_sid>101620</if_sid>
    <match>log_subtype="Detect"</match>
    <description>Sophos XGS IDP detect</description>
    <group>sophos,sophos-xgs,idp,detect,sophos_xgs_critical</group>
  </rule>
</group>
